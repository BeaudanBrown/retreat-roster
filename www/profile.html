{{ define "profile" }}
{{ $staffID := .ID }}
<div id="profileBody" class="px-3 w-full max-w-screen-md grid box-border">
	<script>
		document.addEventListener("DOMContentLoaded", function() {
			document.getElementById('leaveForm').addEventListener('htmx:afterRequest', function(event) {
				window.location.reload();
			});
		});
	</script>

	<h1 class="text-white">Update Your Profile</h1>
	<form class="flex flex-col items-center justify-center"
				hx-ext='json-enc' hx-post="/modifyProfile" hx-swap="outerHTML" hx-target="#profileBody">
		<input type="hidden" name="id" value="{{ .ID }}" />

		<!-- Personal Information -->
		<div class="w-full grid gap-x-6 md:grid-cols-2 box-border">
			<div>
				<label for="firstName" class="block mb-2 text-sm font-medium text-white">First Name</label>
				<input type="text" id="firstName" name="firstName" class="inputAll" value="{{.FirstName}}" required />
			</div>
			<div>
				<label for="lastName" class="block mb-2 text-sm font-medium text-white">Last Name</label>
				<input type="text" id="lastName" name="lastName" class="inputAll" value="{{.LastName}}" required />
			</div>
		</div>
		<div class="w-full">
			<label for="nickName" class="block mb-2 text-sm font-medium text-white">Preferred Name</label>
			<input type="text" id="nickName" name="nickName" class="inputAll" value="{{.NickName}}"/>
		</div>
		<div class="w-full grid gap-x-6 md:grid-cols-2">
			<div>
				<label for="email" class="block mb-2 text-sm font-medium text-white">Email</label>
				<input type="text" id="email" name="email" class="inputAll" value="{{.Email}}" required />
			</div>
			<div>
				<label for="phone" class="block mb-2 text-sm font-medium text-white">Phone #</label>
				<input type="tel" id="phone" name="phone" class="inputAll" value="{{.Phone}}" required />
			</div>
		</div>
		<div class="w-full grid gap-x-6 md:grid-cols-2">
			<div>
				<label for="contactName" class="block mb-2 text-sm font-medium text-white">Emergency Contact Name</label>
				<input type="text" id="contactName" name="contactName" class="inputAll" value="{{.ContactName}}" />
			</div>
			<div>
				<label for="contactPhone" class="block mb-2 text-sm font-medium text-white">Emergency Contact Phone</label>
				<input type="tel" id="contactPhone" name="contactPhone" class="inputAll" value="{{.ContactPhone}}" />
			</div>
		</div>

		<!-- Ideal shifts -->
		<button id="shiftsDropdown" data-dropdown-toggle="ideal-shifts" class="buttonStyle" type="button">Ideal # Shifts <svg class="w-2.5 h-2.5 ms-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
				<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"/>
			</svg>
		</button>

		<div id="ideal-shifts" class="z-10 hidden w-36 divide-y rounded-lg shadow bg-gray-700 divide-gray-600">
			<ul class="p-3 space-y-3 text-sm text-gray-200" aria-labelledby="shiftsDropdown">
				<li>
					<div class="flex items-center">
						<input name="ideal-shifts" {{ if eq .IdealShifts 0 }}checked{{ end }} id="shifts-0" type="radio" value=0 class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
						<label for="shifts-0" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">No shifts</label>
					</div>
				</li>
				<li>
					<div class="flex items-center">
						<input name="ideal-shifts" {{ if eq .IdealShifts 1 }}checked{{ end }} id="shifts-1" type="radio" value=1 class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
						<label for="shifts-1" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">1 shift</label>
					</div>
				</li>
				<li>
					<div class="flex items-center">
						<input name="ideal-shifts" {{ if eq .IdealShifts 2 }}checked{{ end }} id="shifts-2" type="radio" value=2 class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
						<label for="shifts-2" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">2 shifts</label>
					</div>
				</li>
				<li>
					<div class="flex items-center">
						<input name="ideal-shifts" {{ if eq .IdealShifts 3 }}checked{{ end }} id="shifts-3" type="radio" value=3 class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
						<label for="shifts-3" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">3 shifts</label>
					</div>
				</li>
				<li>
					<div class="flex items-center">
						<input name="ideal-shifts" {{ if eq .IdealShifts 4 }}checked{{ end }} id="shifts-4" type="radio" value=4 class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
						<label for="shifts-4" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">4 shifts</label>
					</div>
				</li>
				<li>
					<div class="flex items-center">
						<input name="ideal-shifts" {{ if eq .IdealShifts 5 }}checked{{ end }} id="shifts-5" type="radio" value=5 class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
						<label for="shifts-5" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">5 shifts</label>
					</div>
				</li>
				<li>
					<div class="flex items-center">
						<input name="ideal-shifts" {{ if eq .IdealShifts 6 }}checked{{ end }} id="shifts-6" type="radio" value=6 class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
						<label for="shifts-6" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">6 shifts</label>
					</div>
				</li>
				<li>
					<div class="flex items-center">
						<input name="ideal-shifts" {{ if eq .IdealShifts 7 }}checked{{ end }} id="shifts-7" type="radio" value=7 class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500">
						<label for="shifts-7" class="ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">7 shifts</label>
					</div>
				</li>
			</ul>
		</div>

		<!-- Availability -->
		<div class="w-full mt-4 space-y-4">
			{{ range .Availability }}
			<div class="w-full flex justify-between items-center pb-2 mb-2">
				<label class="text-white basis-1/4">{{ .Name }}</label>
				<div class="inline-flex basis-3/4 rounded-md w-full justify-end">
					<label class="shiftButtonL flex-1 text-center p-2" for="{{.Name}}-early-avail">
						<input type="checkbox" name="{{.Name}}-early-avail" id="{{.Name}}-early-avail" {{ if .Early }}checked{{ end }} class="mr-1">
						Early
					</label>
					<label class="shiftButtonM py-1.5 flex-1 text-center p-2" for="{{.Name}}-mid-avail">
						<input type="checkbox" name="{{.Name}}-mid-avail" id="{{.Name}}-mid-avail" {{ if .Mid }}checked{{ end }} class="mr-1">
						Mid
					</label>
					<label class="shiftButtonR flex-1 text-center p-2" for="{{.Name}}-late-avail">
						<input type="checkbox" name="{{.Name}}-late-avail" id="{{.Name}}-late-avail" {{ if .Late }}checked{{ end }} class="mr-1">
						Late
					</label>
				</div>
			</div>
			{{ end }}
		</div>
		<button class="buttonStyle" type="submit">Save Changes</button>
		{{if .ShowUpdateSuccess }}
		<div  id="success-message">
			<label class="text-white">Success!</label>
		</div>
		{{end}}
		{{if .ShowUpdateError }}
		<div id="success-message">Error!</div>
		{{end}}
	</form>

	<h1 class="mt-2 text-white">Request Leave</h1>
	<form class="flex flex-col items-center justify-center"
		id="leaveForm" hx-ext='json-enc' hx-post="/submitLeave" hx-swap="none">
		<div class="w-full">
			<label for="reason" class="block mb-2 text-sm font-medium text-white">Reason for leave</label>
			<input type="text" id="reason" name="reason" class="inputAll" required />
		</div>

		<div date-rangepicker datepicker-format="dd/mm/yyyy" class="flex items-center justify-center">
			<div class="relative">
				<div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
						 <svg class="w-4 h-4 text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
							<path d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"/>
						</svg>
				</div>
				<input required name="start-date" type="text" class="border text-sm rounded-lg block w-full ps-10 p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500" placeholder="Unavailable from" required>
			</div>
			<span class="mx-4 text-white">untill</span>
			<div class="relative">
				<div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
						 <svg class="w-4 h-4 text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
							<path d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"/>
						</svg>
				</div>
				<input required name="end-date" type="text" class="border text-sm rounded-lg block w-full ps-10 p-2.5 bg-gray-700 border-gray-600 placeholder-gray-400 text-white focus:ring-blue-500 focus:border-blue-500" placeholder="Available again" required>
			</div>
		</div>


		<button class="mt-2 buttonStyle" type="submit">Submit Leave Request</button>
		{{if .ShowLeaveSuccess }}
		<div id="leave-success-message">Success!</div>
		{{end}}
		{{if .ShowLeaveError }}
		<div id="leave-success-message">Invalid dates!</div>
		{{end}}
	</form>

	<div class="w-full mt-2 relative overflow-x-auto shadow-md sm:rounded-lg">
	<table class="w-full text-sm text-center text-gray-400">
		<thead class="text-xs uppercase bg-gray-700 text-gray-400">
			<tr>
				<th>Created</th>
				<th>Reason</th>
				<th>Unavailable from</th>
				<th>Available again</th>
				<th>Delete</th>
			</tr>
		</thead>
		<tbody>
			{{ range .LeaveRequests }}
			<tr class="odd:bg-gray-900 even:bg-gray-800 border-gray-700">
				<td>{{ .CreationDate.Format "02/01/06" }}</td>
				<td>{{ .Reason }}</td>
				<td>{{ .StartDate.Format "02/01/06" }}</td>
				<td>{{ .EndDate.Format "02/01/06" }}</td>
				<td>
					<button type="button"
						class="buttonStyle actionBtn"
						hx-ext="json-enc"
						hx-post="/deleteLeaveReq"
						hx-vals='js:{"id":"{{ .ID }}", "staffID": "{{ $staffID }}", "page":"profile"}'
						hx-swap="outerHTML"
						hx-target="#profileBody">
						Delete
					</button>
				</td>
			</tr>
			{{ end }}
		</tbody>
	</table>
	</div>
	<div class="flex align-center justify-center m-2">
		<button class="buttonStyle"
			hx-ext='json-enc'
			hx-post="/deleteAcc"
			hx-vals='js:{"ID":"{{ .ID }}"}'
			hx-confirm=
			{{if .AdminRights}}
			"Are you sure you want to delete this staff member's account?"
			{{else}}
			"Are you sure you want to delete your account?"
			{{end}}>
			Delete Account
		</button>
	</div>
</div>
{{ end }}
